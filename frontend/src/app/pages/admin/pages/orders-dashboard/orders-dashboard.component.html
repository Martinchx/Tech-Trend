<div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:py-14 mx-auto text-white">
  <div class="flex flex-col">
    <div class="-m-1.5 overflow-x-auto">
      <div class="p-1.5 min-w-full inline-block align-middle">
        <div
          class="border rounded-xl shadow-sm overflow-hidden bg-neutral-900 border-neutral-700"
        >
          <div
            class="px-6 py-4 grid gap-3 md:flex md:justify-between md:items-center border-b border-neutral-700"
          >
            <div class="md:w-1/4">
              <h2 class="text-xl font-semibold text-neutral-200">Orders</h2>
              <p class="text-sm text-neutral-400">
                Filter orders, review them and more.
              </p>
            </div>

            <div class="sm:col-span-2 md:w-1/4">
              <div class="flex sm:justify-end">
                <div
                  class="hs-dropdown [--placement:bottom-right] relative inline-block"
                >
                  <button
                    type="button"
                    class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border shadow-sm disabled:opacity-50 disabled:pointer-events-none bg-neutral-900 border-neutral-700 hover:bg-neutral-800"
                  >
                    <svg
                      class="flex-shrink-0 size-3.5"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <path d="M3 6h18" />
                      <path d="M7 12h10" />
                      <path d="M10 18h4" />
                    </svg>
                    Filters
                  </button>
                  <div
                    class="hs-dropdown-menu transition-[opacity,margin] duration hs-dropdown-open:opacity-100 opacity-0 hidden divide-y min-w-48 z-10 shadow-md rounded-lg p-2 mt-2 divide-neutral-700 bg-neutral-800 border border-neutral-700"
                    aria-labelledby="hs-as-table-table-filters-dropdown"
                  >
                    <div class="py-2 first:pt-0 last:pb-0">
                      <span
                        class="block py-2 px-3 text-xs font-medium uppercase text-neutral-600"
                      >
                        Filters
                      </span>
                      <div class="flex flex-col gap-1">
                        <a
                          [ngClass]="{
                            'bg-neutral-700 text-white':
                              filter().sortBy === sortBy.NEWEST
                          }"
                          (click)="applyFilter(sortBy.NEWEST)"
                          class="flex items-center gap-x-3 py-2 px-3 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 text-neutral-400 hover:bg-neutral-700 hover:text-white cursor-pointer"
                        >
                          <svg
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="icon icon-tabler icons-tabler-outline icon-tabler-clock-up flex-shrink-0 size-5"
                          >
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M20.983 12.548a9 9 0 1 0 -8.45 8.436" />
                            <path d="M19 22v-6" />
                            <path d="M22 19l-3 -3l-3 3" />
                            <path d="M12 7v5l2.5 2.5" />
                          </svg>
                          Newest
                        </a>
                        <a
                          [ngClass]="{
                            'bg-neutral-700 text-white':
                              filter().sortBy === sortBy.OLDEST
                          }"
                          (click)="applyFilter(sortBy.OLDEST)"
                          class="flex items-center gap-x-3 py-2 px-3 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 text-neutral-400 hover:bg-neutral-700 hover:text-white cursor-pointer"
                        >
                          <svg
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="icon icon-tabler icons-tabler-outline icon-tabler-clock-down flex-shrink-0 size-5"
                          >
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M20.984 12.535a9 9 0 1 0 -8.431 8.448" />
                            <path d="M12 7v5l3 3" />
                            <path d="M19 16v6" />
                            <path d="M22 19l-3 3l-3 -3" />
                          </svg>
                          Oldest
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <table class="min-w-full divide-y divide-neutral-700">
            <thead class="bg-neutral-800">
              <tr>
                <th scope="col" class="px-6 py-3 text-start">
                  <div class="flex items-center gap-x-2">
                    <span
                      class="text-xs font-semibold uppercase tracking-wide text-neutral-200"
                    >
                      User
                    </span>
                  </div>
                </th>

                <th scope="col" class="px-6 py-3 text-start">
                  <div class="flex items-center gap-x-2">
                    <span
                      class="text-xs font-semibold uppercase tracking-wide text-neutral-200"
                    >
                      Products Purchased
                    </span>
                  </div>
                </th>

                <th scope="col" class="px-6 py-3 text-start">
                  <div class="flex items-center gap-x-2">
                    <span
                      class="text-xs font-semibold uppercase tracking-wide text-neutral-200"
                    >
                      Total
                    </span>
                  </div>
                </th>

                <th scope="col" class="px-6 py-3 text-start">
                  <div class="flex items-center gap-x-2">
                    <span
                      class="text-xs font-semibold uppercase tracking-wide text-neutral-200"
                    >
                      Date of purchased
                    </span>
                  </div>
                </th>
              </tr>
            </thead>

            <tbody class="divide-y divide-neutral-700">
              @for (order of orders(); track $index) {
              <tr class="bg-neutral-900">
                <td class="size-px whitespace-nowrap align-top p-6">
                  <span class="text-sm font-semibold text-neutral-200">{{
                    order.user.fullname
                  }}</span>
                </td>
                <td class="size-px whitespace-nowrap align-top p-6">
                  <button
                    (click)="getOrderDetails(order.order_id)"
                    [disabled]="processing()"
                    data-hs-overlay="#order-details"
                    class="group relative inline-flex h-9 items-center justify-center overflow-hidden rounded-md bg-blue-500 px-6 font-medium duration-500 disabled:opacity-60 disabled:cursor-not-allowed"
                  >
                    <div
                      class="translate-x-0 opacity-100 transition group-hover:-translate-x-[150%] group-hover:opacity-0"
                    >
                      Review Products
                    </div>
                    <div
                      class="absolute translate-x-[150%] opacity-0 transition group-hover:translate-x-0 group-hover:opacity-100"
                    >
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        class="icon icon-tabler icons-tabler-outline icon-tabler-eye-search"
                      >
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
                        <path
                          d="M12 18c-.328 0 -.652 -.017 -.97 -.05c-3.172 -.332 -5.85 -2.315 -8.03 -5.95c2.4 -4 5.4 -6 9 -6c3.465 0 6.374 1.853 8.727 5.558"
                        />
                        <path d="M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" />
                        <path d="M20.2 20.2l1.8 1.8" />
                      </svg>
                    </div>
                  </button>
                </td>
                <td class="size-px whitespace-nowrap align-top p-6">
                  <span class="text-sm text-neutral-400">{{
                    order.total | currency
                  }}</span>
                </td>

                <td class="size-px whitespace-nowrap align-top p-6">
                  <span class="text-sm text-neutral-400">{{
                    order.createdAt | date : "MM/dd/y, hh:mm a"
                  }}</span>
                </td>
              </tr>
              }
            </tbody>
          </table>

          <div
            class="px-6 py-4 gap-3 flex md:justify-end border-t border-neutral-700"
          >
            <div>
              <div class="inline-flex gap-x-2">
                <button
                  (click)="updatePage(-1)"
                  [disabled]="!paginationButtons().next || processing()"
                  type="button"
                  class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border shadow-sm disabled:opacity-50 disabled:pointer-events-none bg-neutral-900 border-neutral-700 hover:bg-neutral-800"
                >
                  <svg
                    class="flex-shrink-0 size-4"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="m15 18-6-6 6-6" />
                  </svg>
                  Prev
                </button>

                <button
                  (click)="updatePage(1)"
                  [disabled]="!paginationButtons().next || processing()"
                  type="button"
                  class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border shadow-sm disabled:opacity-50 disabled:pointer-events-none bg-neutral-900 border-neutral-700 hover:bg-neutral-800"
                >
                  Next
                  <svg
                    class="flex-shrink-0 size-4"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="m9 18 6-6-6-6" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  id="order-details"
  class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto text-white"
>
  <div
    class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-5xl sm:w-full m-3 sm:mx-auto"
  >
    <div class="relative flex flex-col shadow-lg rounded-xl bg-neutral-900">
      <div class="absolute top-2 end-2">
        <button
          type="button"
          class="flex justify-center items-center size-7 text-sm font-semibold rounded-lg border disabled:opacity-50 disabled:pointer-events-none border-transparent hover:bg-neutral-700"
          data-hs-overlay="#order-details"
        >
          <span class="sr-only">Close</span>
          <svg
            class="flex-shrink-0 size-4"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M18 6 6 18" />
            <path d="m6 6 12 12" />
          </svg>
        </button>
      </div>

      <div class="p-4 sm:p-14 text-center overflow-y-auto">
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 pt-10 sm:pt-0">
          @for (product of orderDetails()?.products; track $index) {
          <div
            class="flex flex-col border shadow-sm rounded-xl bg-neutral-900 border-neutral-700 shadow-neutral-700/70"
          >
            <img
              [src]="product.product.image_url"
              [alt]="product.product.name"
              class="w-full h-48 object-cover rounded-t-lg"
              style="aspect-ratio: 400/300; object-fit: cover"
            />
            <div class="p-4 md:p-5">
              <h3 class="text-lg font-bold line-clamp-1">
                {{ product.product.name }}
              </h3>
              <div class="flex flex-col items-start gap-1 mt-4">
                <span class="block text-neutral-400"
                  >Price: {{ product.product.price | currency }}</span
                >
                <span class="block text-neutral-400"
                  >Quantity: {{ product.quantity }}</span
                >
                <span class="block text-neutral-400"
                  >Subtotal: {{ product.subtotal | currency }}</span
                >
              </div>
            </div>
          </div>
          }
        </div>

        <span class="block mt-4 md:mt-8 font-bold text-lg"
          >Total: {{ orderDetails()?.total | currency }}</span
        >
      </div>
    </div>
  </div>
</div>
